I"z¶<h2 id="kaggle-study-1---walmart-saletype-classification">Kaggle Study #1. - Walmart SaleType Classification</h2>

<p>â€‹	ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë£° Kaggle competitionì€ Walmart SaleType Classificationì…ë‹ˆë‹¤. Walmartì—ì„œ ì œê³µë˜ëŠ” ê³ ê°ë“¤ì˜ êµ¬ë§¤ì´ë ¥ dataë¥¼ ë°”íƒ•ìœ¼ë¡œ í•´ë‹¹ ê³ ê°ì˜ êµ¬ë§¤íƒ€ì…ì„ ì˜ˆì¸¡í•´ë³´ëŠ” competitionì…ë‹ˆë‹¤. ìš°ì„  datasetì˜ ê¸°ë³¸ì ì¸ í˜•íƒœë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"./train.csv"</span><span class="p">)</span>

<span class="n">train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>999</td>
      <td>5</td>
      <td>Friday</td>
      <td>6.811315e+10</td>
      <td>-1</td>
      <td>FINANCIAL SERVICES</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>6.053882e+10</td>
      <td>1</td>
      <td>SHOES</td>
      <td>8931.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>7.410811e+09</td>
      <td>1</td>
      <td>PERSONAL CARE</td>
      <td>4504.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2.238404e+09</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>3565.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2.006614e+09</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>1017.0</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"train setì˜ shapeì€"</span><span class="p">,</span> <span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="s">"/ test setì˜ shapeì€"</span><span class="p">,</span> <span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>train setì˜ shapeì€ (647054, 7) / test setì˜ shapeì€ (653646, 6)
</code></pre></div></div>

<p>â€‹	Datasetì—ëŠ” ì´ 7ê°œì˜ ë³€ìˆ˜ê°€ ìˆìœ¼ë©°, ì´ ì¤‘ TripTypeì´ ìš°ë¦¬ê°€ ë§ì¶”ì–´ì•¼í•  êµ¬ë§¤ íƒ€ì… ë³€ìˆ˜ì…ë‹ˆë‹¤. Trainê³¼ Test setì— ì•½ 65ë§Œ ê±´ì˜ êµ¬ë§¤ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì œ ì´ ë°ì´í„°ì˜ íŠ¹ì§•ì— ëŒ€í•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="data-eda">Data EDA</h2>

<h3 id="triptype">TripType</h3>

<p>â€‹	Competition descriptionì„ ì‚´í´ë³´ë©´ TripTypeë³€ìˆ˜ì˜ 999 ê°’ì€ â€œê¸°íƒ€â€ í•­ëª©ì…ë‹ˆë‹¤. plotì˜ ê°€ë…ì„±ì„ ìœ„í•´ ì´ ê°’ì„ -1ë¡œ ë³€ê²½í•œ ë’¤ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<p><img src="https://decision-J.github.io/assets/walmart/output_3_0.jpg" alt="png" width="400" height="400" /></p>

<p>â€‹	Typeê°’ì´ 0~44ê¹Œì§€ ì¡´ì¬í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒë‹¹íˆ ë§ì€ multi-label classification ë¬¸ì œ ì…ë‹ˆë‹¤. ë˜ í•œê°€ì§€ ì£¼ëª©í• ë§Œí•œ íŠ¹ì§•ì€ ë§ì€ íƒ€ì…ë“¤ ì¤‘ 39ì™€ 40ë²ˆ íƒ€ì…ì´ ëˆˆì— ë„ê²Œ ë§ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. íŠ¹íˆ 40ë²ˆ typeì€ êµ‰ì¥íˆ ë§ì€ ë¹ˆë„ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ë‘ ê°€ì§€ typeì— ëŒ€í•œ íŠ¹ì§•ì„ ì˜ ì¡ì•„ë‚´ëŠ” ê²ƒì´ ì¤‘ìš”í•  ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.</p>

<h3 id="weekday">Weekday</h3>

<p><img src="https://decision-J.github.io/assets/walmart/output_3.jpg" alt="png2" width="400" height="400" />
â€‹
â€‹	Weekdayë³€ìˆ˜ëŠ” ë¬¼ê±´ì„ êµ¬ë§¤í•œ ìš”ì¼ì— ëŒ€í•œ ì •ë³´ì…ë‹ˆë‹¤. ì•„ë¬´ë˜ë„ íœ´ì¼ì¸ ê¸ˆ, í† , ì¼ì— ëŒ€í•œ ì •ë³´ê°€ ë§ì€ ê²ƒì´ í™•ì¸ë©ë‹ˆë‹¤. í‰ì¼ê³¼ ì£¼ë§ë¡œ êµ¬ë¶„í•˜ì—¬ ë¶„ì„í•˜ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì¼ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>

<h3 id="scancount">ScanCount</h3>

<p><img src="https://decision-J.github.io/assets/walmart/output_3.1.jpg" alt="png3" width="400" height="400" />
â€‹</p>

<p>â€‹	ScanCount ë³€ìˆ˜ëŠ” ê³ ê°ì´ êµ¬ì…í•œ ë¬¼ê±´ì˜ ê°œìˆ˜ì— ê´€í•œ ì •ë³´ì…ë‹ˆë‹¤. ì£¼ë¡œ 1ê°œì˜ ë¬¼ê±´ì„ êµ¬ì…í•˜ëŠ” ê³ ê°ì´ ë§ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€ ë§ì€ ë¬¼í’ˆì„ êµ¬ì…í•œ ê°œìˆ˜ëŠ” 5ê°œì…ë‹ˆë‹¤. -1ê°’ì€ ê³ ê°ì´ ë¬¼ê±´ì„ â€œë°˜í’ˆâ€ ì²˜ë¦¬ í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ê·¸ ìˆ˜ê°€ ë§ì§€ëŠ” ì•Šì§€ë§Œ íŠ¹ìˆ˜í•œ Typeì„ êµ¬ë¶„í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì´ì— ì–´ë–¤ í’ˆëª©ì´ ê°€ì¥ ë§ì´ ë°˜í’ˆë˜ëŠ”ì§€ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'ScanCount'</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">][</span><span class="s">"DepartmentDescription"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">().</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FINANCIAL SERVICES    1138
LADIESWEAR             786
PRODUCE                687
PERSONAL CARE          624
MENS WEAR              618
DSD GROCERY            599
GROCERY DRY GOODS      524
PHARMACY OTC           439
ELECTRONICS            436
BEAUTY                 426
Name: DepartmentDescription, dtype: int64
</code></pre></div></div>

<p>â€‹</p>

<p>â€‹	ë°˜í’ˆì´ ê°€ì¥ ë§ì€ ìƒìœ„ 10ê°œ í’ˆëª©ì„ ë½‘ì•˜ìŠµë‹ˆë‹¤. ê¸ˆìœµ ì„œë¹„ìŠ¤ê°€ ê°€ì¥ ì·¨ì†Œê°€ ë§ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ë˜í•œ ì˜ë¥˜,  ì•½í’ˆ ê°™ì€ ìƒí•„í’ˆì˜ ë°˜í’ˆì´ ê°€ì¥ ë§ì€ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.</p>

<h3 id="upc-departmentdescription-finelinenumber">UPC, DepartmentDescription, FinelineNumber</h3>

<p>â€‹	UPCì™€ DepartmentDescription, FinelineNumber ì´ 3ê°€ì§€ ë³€ìˆ˜ëŠ” í•œêº¼ë²ˆì— ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” ì²« ì§¸,  ì „ì²´ data setì—ì„œ ê²°ì¸¡ê°’ì´ ì¡´ì¬í•˜ëŠ” ë³€ìˆ˜ë“¤ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë‘˜ ì§¸, UPCì™€ FinelineNumberë³€ìˆ˜ëŠ” ìœ ì‚¬ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ë¨¼ì € ì´ë“¤ì˜ ê²°ì¸¡ê°’ì— ëŒ€í•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>

<span class="n">VisitNumber</span>                 <span class="mi">0</span>
<span class="n">Weekday</span>                     <span class="mi">0</span>
<span class="n">Upc</span>                      <span class="mi">3986</span>
<span class="n">ScanCount</span>                   <span class="mi">0</span>
<span class="n">DepartmentDescription</span>    <span class="mi">1328</span>
<span class="n">FinelineNumber</span>           <span class="mi">3986</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</code></pre></div></div>

<p>â€‹	UPCì™€ FinelineNumberëŠ” ì •í™•íˆ ë™ì¼í•œ ê²°ì¸¡ê°’ì˜ ìˆ˜ë¥¼ ê°€ì§‘ë‹ˆë‹¤. ë‘ ë³€ìˆ˜ëŠ” ëª¨ë‘ Walmartì—ì„œ ê³ ìœ í•˜ê²Œ ë¶€ì—¬í•œ ìƒí’ˆì— ëŒ€í•œ ì •ë³´ì¸ë°, ê²°ì¸¡ê°’ì˜ ì¶”ì´ë¡œ ë³´ì•„ ë™ì¼í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì—¬ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ì¶”í›„ ë¶„ì„ì—ì„œëŠ” ë‘ ë³€ìˆ˜ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  FinelineNumberë§Œ ì´ìš©í•˜ê² ìŠµë‹ˆë‹¤. (FinelineNumberë¥¼ ì„ íƒí•œ ì´ìœ ëŠ” UPCì— ë¹„í•´ ìë£Œì˜ ê°’ì´ ë” ì§ê´€ì ìœ¼ë¡œ í‘œí˜„ë˜ì–´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.) ë˜í•œ DepartmentDescription 1,328ê°œ ë³€ìˆ˜ë„ FinelineNumber Missing caseì— í¬í•¨ë©ë‹ˆë‹¤.</p>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>548</th>
      <td>27</td>
      <td>259</td>
      <td>Friday</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>549</th>
      <td>27</td>
      <td>259</td>
      <td>Friday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>959</th>
      <td>-1</td>
      <td>409</td>
      <td>Friday</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1116</th>
      <td>39</td>
      <td>479</td>
      <td>Friday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>643137</th>
      <td>41</td>
      <td>190408</td>
      <td>Sunday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>643991</th>
      <td>44</td>
      <td>190651</td>
      <td>Sunday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>645990</th>
      <td>44</td>
      <td>191080</td>
      <td>Sunday</td>
      <td>NaN</td>
      <td>-1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>645991</th>
      <td>44</td>
      <td>191080</td>
      <td>Sunday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>645992</th>
      <td>44</td>
      <td>191080</td>
      <td>Sunday</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3986 rows Ã— 7 columns</p>

<p>â€‹	ê·¸ë ‡ë‹¤ë©´ FinelineNumberì˜ ê°’ì´ Missingì´ì§€ë§Œ DepartmentDescriptionì˜ ê°’ì´ Not Missingì¸ caseëŠ” ì–´ë–¤ ê²ƒì¼ê¹Œìš”?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[(</span><span class="n">train</span><span class="p">[</span><span class="s">'FinelineNumber'</span><span class="p">].</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'DepartmentDescription'</span><span class="p">].</span><span class="n">notnull</span><span class="p">())][</span><span class="s">'DepartmentDescription'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PHARMACY RX    2768
Name: DepartmentDescription, dtype: int64
</code></pre></div></div>

<p>â€‹	<em>PHARMACY RX</em> ë¼ëŠ” í’ˆëª©ì´ì—ˆìŠµë‹ˆë‹¤. ë‹¨ì¼ í’ˆëª©ë§Œì´ ì¡°íšŒë˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ í•´ë‹¹ í’ˆëª©ì— ëŒ€í•œ FinelineNumber ë³€ìˆ˜ ì…ë ¥ ì²˜ë¦¬ì— ì–´ë–¤ ë¬¸ì œê°€ ìˆì—ˆë˜ ê²ƒìœ¼ë¡œ ë³´ì—¬ì§‘ë‹ˆë‹¤.</p>

<h2 id="base-line-model">Base-line Model</h2>

<p>â€‹	ìš°ì„  ê°€ì¥ ê°„ë‹¨í•˜ê²Œ base-line modelì„ ë§Œë“¤ì–´ì„œ ì„±ëŠ¥ì„ ì²´í¬í•´ë³´ê² ìŠµë‹ˆë‹¤. Base-line modelì´ë‹ˆ ë§Œí¼ ê°€ì¥ ê°„ë‹¨í•˜ê²Œ buildingí•˜ì—¬ ì„±ëŠ¥ì˜ ë°”ë¡œë¯¸í„°ë¡œ ì‚¼ê² ìŠµë‹ˆë‹¤.</p>

<p>â€‹	ë¨¼ì € EDAë¥¼ í†µí•´ ì–»ì€ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë°ì´í„° ì „ì²˜ë¦¬ ê³¼ì •ì„ ê±°ì³ë´…ë‹ˆë‹¤.</p>

<ol>
  <li>UPC ë³€ìˆ˜ ì œê±°</li>
  <li>FinelineNumber ë³€ìˆ˜ ê²°ì¸¡ê°’ ì œê±°</li>
  <li>Weekdayë³€ìˆ˜: ê¸ˆí† ì¼ = 1, í‰ì¼ = 0 ìœ¼ë¡œ ë²”ì£¼í™”</li>
  <li>ë¬¸ìí˜• ë³€ìˆ˜ DepartmentDescription ì œê±°</li>
  <li>VisitNumber ê¸°ì¤€ ì¤‘ë³µ í–‰ ì œê±°</li>
</ol>

<p>â€‹	ìµœëŒ€í•œ ê°„ë‹¨í•˜ê²Œ modelì„ constructí•˜ëŠ” ê²ƒì´ ëª©ì ì´ë¯€ë¡œ ì •ë³´ì˜ ì†ì‹¤ì„ ê°ìˆ˜í•˜ê³  ê³¼ê°íˆ ë³€ìˆ˜ë“¤ì„ ì œê±°í•˜ì˜€ìŠµë‹ˆë‹¤. Buildingí•œ modelì˜ specì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">def</span> <span class="nf">build_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">x_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)))</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>

    <span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'rmsprop'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></div>

<p>â€‹	Kerasë¥¼ ì‚¬ìš©í•˜ì—¬ Deep Learning ëª¨ë¸ì„ êµ¬ì¶•í•˜ì˜€ìœ¼ë©° 3ê°œì˜ ì¸µì„ ìŒ“ì•˜ìŠµë‹ˆë‹¤. rsmprop optimizerë¥¼ ì‚¬ìš©í•˜ê³  categorical_crossentropyë¥¼ loss functionìœ¼ë¡œ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. Metricì€ Customizeë¥¼ í†µí•´ build-upí•  ìˆ˜ ìˆìœ¼ë‚˜ ê°„ë‹¨í•˜ê²Œ accuracyë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<p>â€‹	3-foldë¡œ ëª¨ë¸ì„ í•™ìŠµí•œ ê²°ê³¼ Kaggle leaderë³´ë“œ ê¸°ì¤€ <strong>2.36</strong> ì˜ scoreë¥¼ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.</p>

<h2 id="advanced-model-with-feature-engineering">Advanced Model with Feature Engineering</h2>

<p>â€‹	ë‹¤ìŒìœ¼ë¡œ Feature engineeringì„ ê±°ì¹œ ë³´ë‹¤ ë°œì „ëœ modelì„ ë§Œë“¤ì–´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. Department Descriptionë³€ìˆ˜ì™€ FinelineNumber ë³€ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ íŒŒìƒë³€ìˆ˜ë¥¼ ìƒì„±í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h3 id="departmentdescription-íŒŒìƒë³€ìˆ˜">DepartmentDescription íŒŒìƒë³€ìˆ˜</h3>

<blockquote>
  <p><em>í•´ë‹¹ ì‘ì—…ì€ Coursera: Learning from the Top Kagglers ê°•ì˜ë¥¼ ì°¸ê³ í•˜ì˜€ìŒì„ ë°í™ë‹ˆë‹¤.</em></p>
</blockquote>

<p>â€‹	ì•ì„œ base-line modelì—ì„œëŠ” DepartmentDescription ë³€ìˆ˜ë¥¼ ì œê±°í•˜ê³  ë¶„ì„ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” Visit Numberë‹¹ ì¤‘ë³µ ì •ë³´ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì´ì—ˆìŠµë‹ˆë‹¤. ì´ ê²ƒì´ ì–´ë–¤ ì ì´ ë¬¸ì œì¸ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ì£¼ì–´ì§„ dataëŠ” êµ¬ë§¤ì´ë ¥ ë°ì´í„°ì…ë‹ˆë‹¤. ì¦‰, VisitNumberëŠ” ê³ ê°ì˜ IDì´ë©° VisitNumber í•˜ë‚˜ë‹¹ êµ¬ë§¤ ë¬¼í’ˆ ì •ë³´ë“¤ì´ ì¤‘ë³µë˜ì–´ ë“¤ì–´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒê³¼ ê°™ì€ ì‚¬ë¡€ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">"VisitNumber"</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FinelineNumber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>55</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>7.675336e+09</td>
      <td>1</td>
      <td>IMPULSE MERCHANDISE</td>
      <td>8904.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>6.115665e+10</td>
      <td>1</td>
      <td>JEWELRY AND SUNGLASSES</td>
      <td>556.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>8.874396e+10</td>
      <td>1</td>
      <td>MENS WEAR</td>
      <td>144.0</td>
    </tr>
    <tr>
      <th>58</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>6.926568e+11</td>
      <td>1</td>
      <td>FABRICS AND CRAFTS</td>
      <td>397.0</td>
    </tr>
    <tr>
      <th>59</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>7.675336e+09</td>
      <td>1</td>
      <td>IMPULSE MERCHANDISE</td>
      <td>8904.0</td>
    </tr>
    <tr>
      <th>60</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>6.953344e+11</td>
      <td>1</td>
      <td>ACCESSORIES</td>
      <td>122.0</td>
    </tr>
    <tr>
      <th>61</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>8.853064e+10</td>
      <td>1</td>
      <td>MENS WEAR</td>
      <td>5201.0</td>
    </tr>
    <tr>
      <th>62</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>8.830961e+10</td>
      <td>1</td>
      <td>MENS WEAR</td>
      <td>5661.0</td>
    </tr>
    <tr>
      <th>63</th>
      <td>42</td>
      <td>19</td>
      <td>Friday</td>
      <td>3.181070e+09</td>
      <td>1</td>
      <td>HOME MANAGEMENT</td>
      <td>8124.0</td>
    </tr>
  </tbody>
</table>

<p>â€‹	ìœ„ ìë£ŒëŠ” VisitNumberê°€ 19ì¸ ê³ ê°ì˜ ì •ë³´ë§Œì„ ë”°ë¡œ ì¶”ë ¤ë‚¸ ê²ƒì…ë‹ˆë‹¤. ìë£Œë¥¼ ì‚´í´ë³´ë©´ 19ë²ˆ ê³ ê°ì´ ê°™ì€ ë‚ ì— ì´ 9ê°œì˜ í’ˆëª©ì„ êµ¬ë§¤í•˜ì˜€ìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DepartmentDescription ë³€ìˆ˜ë¥¼ ë³´ë©´ ë‹¤ì–‘í•œ í’ˆëª©ë“¤ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ëª¨ë“  í–‰ì˜ TripTypeì´ ë™ì¼í•˜ê²Œ 42ë¡œ ê·œì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¦‰, Walmart ì¸¡ì—ì„œëŠ” ì´ 9ê°œ í’ˆëª©ì˜ ì •ë³´ë¥¼ ì „ë¶€ ë°˜ì˜í•˜ì—¬ (ë™ì¼í•œ ë‚ ì˜ êµ¬ë§¤ ì •ë³´ë¥¼ ëª¨ë‘ ë°˜ì˜í•˜ì—¬) ê³ ê°ì˜ êµ¬ë§¤ Typeì„ ì •í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìµœì¢… ëª¨ë¸ì— VisitNumberë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µì œê±°ë¥¼ í•  ì‹œ ë‚˜ë¨¸ì§€ í’ˆëª©ë“¤ì˜ ì •ë³´ê°€ ëª¨ë‘ ì‚¬ë¼ì§€ê²Œ ë˜ì–´ ì •í™•í•œ ë¶„ì„ì´ ë¶ˆê°€ëŠ¥í•´ì§€ê²Œ ë©ë‹ˆë‹¤.</p>

<p>â€‹	ë”°ë¼ì„œ ëª¨ë“  í’ˆëª©ì— ëŒ€í•œ ì •ë³´ë¥¼ ë°˜ì˜í•˜ëŠ” ì‘ì—…ì„ ê±°ì¹  ê²ƒì…ë‹ˆë‹¤. ê·¸ ë°©ë²•ì€ VisitNumberë¥¼ ê¸°ì¤€ìœ¼ë¡œ DepartmentDescription ì •ë³´ë¥¼ íš¡ìœ¼ë¡œ ëŠ˜ì–´ ë†“ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒì˜ ì˜ˆì‹œë¥¼ ë³´ë©´ ì´í•´ê°€ ì‰½ìŠµë‹ˆë‹¤.</p>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VisitNumber</th>
      <th>1-HR PHOTO</th>
      <th>ACCESSORIES</th>
      <th>AUTOMOTIVE</th>
      <th>BAKERY</th>
      <th>BATH AND SHOWER</th>
      <th>BEAUTY</th>
      <th>BEDDING</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>94242</th>
      <td>191343</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>94243</th>
      <td>191344</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>94244</th>
      <td>191345</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>94245</th>
      <td>191346</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>94246</th>
      <td>191347</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>

<p>â€‹	DepartmentDescription ë³€ìˆ˜ì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  ê°’ë“¤ì„ ìƒˆë¡œìš´ ë³€ìˆ˜ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ í›„ í•´ë‹¹ í’ˆëª©ì´ ìˆìœ¼ë©´ 1, ì—†ìœ¼ë©´ 0ì„ ë°˜í™˜í•˜ëŠ” one-hot encodingì„ í†µí•´ ë³€ìˆ˜ ì •ë³´ë¥¼ ì¶”ê°€í•´ì£¼ë©´ ë©ë‹ˆë‹¤.</p>

<blockquote>
  <p><em>ì´ ë°©ë²•ì€ ìˆ˜ ë§ì€ 0,1 ë³€ìˆ˜ë“¤ì„ ìƒì„±í•˜ê²Œ ë˜ì–´, Sparse dataê°€ ê°–ëŠ” ë¬¸ì œë¥¼ ì•¼ê¸°í•  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. ì¼ë‹¨ ë³€ìˆ˜ë¥¼ ìƒì„±í•˜ê³  ë¶„ì„ì„ ì§„í–‰í•´ë³¸ ë’¤ ì¶”ê°€ ë…¼ì˜ í•´ë³´ê² ìŠµë‹ˆë‹¤.</em></p>
</blockquote>

<h3 id="finelinenumber-íŒŒìƒë³€ìˆ˜">FinelineNumber íŒŒìƒë³€ìˆ˜</h3>

<p>â€‹	FinelineNumber ë˜í•œ DepartmentDescriptionê³¼ ë™ì¼í•œ ë¬¸ì œë¥¼ ê°–ê³  ìˆìŠµë‹ˆë‹¤. VisitNumberë³„ë¡œ ì •ë³´ê°€ ì¤‘ë³µëœë‹¤ëŠ” ê²ƒì¸ë°ìš”. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‘ ê°€ì§€ íŒŒìƒ ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ë³´ê³ ì í•©ë‹ˆë‹¤. ì²« ì§¸, <strong>FinelineNumberì˜ Countë¥¼ í™œìš©</strong>í•˜ëŠ” ë³€ìˆ˜, ë‘˜ ì§¸, <strong>FinelineNumberì˜ CountSum</strong>ì„ í™œìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<ol>
  <li>
    <p><strong>FinelineNumberì˜ Countê°’ì„ í™œìš©</strong></p>

    <p>â€‹	FinelineNumberëŠ” 0~2,000ê¹Œì§€ ë‹¤ì–‘í•œ ê°’ì„ ê°–ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í’ˆëª© ë³„ë¡œ ê³ ê°ë“¤ì´ ìì£¼ êµ¬ë§¤í•˜ëŠ” í’ˆëª©, ìì£¼ êµ¬ë§¤í•˜ì§€ ì•ŠëŠ” í’ˆëª©ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. ë”°ë¼ì„œ ê° FinelineNumberë“¤ì„ Countê°’ìœ¼ë¡œ ë³€í™˜í•œ ë’¤, VisitNumberë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¸ ê°’ì„ í‰ê· ë‚´ì–´ ë³€ìˆ˜ë¡œ í™œìš©í•´ë³´ê² ìŠµë‹ˆë‹¤. ì´ ë³€ìˆ˜ë¥¼ í†µí•´ ê³ ê°ì´ ë³´í¸ì ì¸ ì„±í–¥ì„ ê°–ëŠ” íƒ€ì…ì¸ì§€, ë§ˆì´ë„ˆí•œ í’ˆëª©ì„ ì¦ê²¨ ì°¾ëŠ” ê³ ê°ì¸ì§€ë¥¼ ì‚´í´ë³¼ ìˆ˜ ìˆì„ ê²ë‹ˆë‹¤.</p>

    <p>â€‹	ë¨¼ì € FinlineNumber ê°’ì˜ Count ê°’ì„ êµ¬í•´ë´…ë‹ˆë‹¤.</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FineLineCount</span> <span class="o">=</span> <span class="n">train</span><span class="p">[[</span><span class="s">'VisitNumber'</span><span class="p">,</span><span class="s">'FinelineNumber'</span><span class="p">]].</span><span class="n">groupby</span><span class="p">(</span><span class="s">'FinelineNumber'</span><span class="p">).</span><span class="n">count</span><span class="p">()</span>
</code></pre></div>    </div>

    <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VisitNumber</th>
    </tr>
    <tr>
      <th>FinelineNumber</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>3837</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>461</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>224</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>94</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>187</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>9974.0</th>
      <td>54</td>
    </tr>
    <tr>
      <th>9975.0</th>
      <td>28</td>
    </tr>
    <tr>
      <th>9991.0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>9997.0</th>
      <td>50</td>
    </tr>
    <tr>
      <th>9998.0</th>
      <td>411</td>
    </tr>
  </tbody>
</table>
    <p>5195 rows Ã— 1 columns</p>
  </li>
</ol>

<p>â€‹			ì´ì œ ì´ ê°’ì„ datasetì— ë°˜ì˜í•˜ì—¬ VisitNumberë¥¼ ê¸°ì¤€ìœ¼ë¡œ í‰ê· ë‚¸ ë³€ìˆ˜ë¥¼ êµ¬í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TripType</th>
      <th>VisitNumber</th>
      <th>Weekday</th>
      <th>Upc</th>
      <th>ScanCount</th>
      <th>DepartmentDescription</th>
      <th>FineLineCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>999</td>
      <td>5</td>
      <td>Friday</td>
      <td>6.811315e+10</td>
      <td>-1</td>
      <td>FINANCIAL SERVICES</td>
      <td>836.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>6.053882e+10</td>
      <td>1</td>
      <td>SHOES</td>
      <td>98.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>7</td>
      <td>Friday</td>
      <td>7.410811e+09</td>
      <td>1</td>
      <td>PERSONAL CARE</td>
      <td>98.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2.238404e+09</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>420.045455</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>8</td>
      <td>Friday</td>
      <td>2.006614e+09</td>
      <td>2</td>
      <td>PAINT AND ACCESSORIES</td>
      <td>420.045455</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>647049</th>
      <td>39</td>
      <td>191346</td>
      <td>Sunday</td>
      <td>3.239000e+10</td>
      <td>1</td>
      <td>PHARMACY OTC</td>
      <td>645.823529</td>
    </tr>
    <tr>
      <th>647050</th>
      <td>39</td>
      <td>191346</td>
      <td>Sunday</td>
      <td>7.874205e+09</td>
      <td>1</td>
      <td>FROZEN FOODS</td>
      <td>645.823529</td>
    </tr>
    <tr>
      <th>647051</th>
      <td>39</td>
      <td>191346</td>
      <td>Sunday</td>
      <td>4.072000e+03</td>
      <td>1</td>
      <td>PRODUCE</td>
      <td>645.823529</td>
    </tr>
    <tr>
      <th>647052</th>
      <td>8</td>
      <td>191347</td>
      <td>Sunday</td>
      <td>4.190008e+09</td>
      <td>1</td>
      <td>DAIRY</td>
      <td>1277.500000</td>
    </tr>
    <tr>
      <th>647053</th>
      <td>8</td>
      <td>191347</td>
      <td>Sunday</td>
      <td>3.800060e+09</td>
      <td>1</td>
      <td>GROCERY DRY GOODS</td>
      <td>1277.500000</td>
    </tr>
  </tbody>
</table>
<p>647054 rows Ã— 7 columns</p>

<p>â€‹			ìœ„ data setì˜ ë§¨ ì˜¤ë¥¸ìª½ì— ìƒˆë¡œìš´ íŒŒìƒë³€ìˆ˜ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. 7ë²ˆ VisitNumberë¥¼ ê°€ì§„ ê³ ê°ì€ 98.5ì˜ ê°’	ì„ ê°–ëŠ” ê²ƒìœ¼ë¡œ ë³´ì•„ ë‹¤ë¥¸ ê³ ê°ë“¤ë³´ë‹¤ ë§ˆì´ë„ˆí•œ ë¬¼ê±´ í’ˆëª©ë“¤ì„ êµ¬ì…í–ˆì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. (ì‹¤ì œë¡œ Shoesë‚˜ 	personal careì™€ ê°™ì€ í’ˆëª©ì€ êµ¬ë§¤ ë¹ˆë„ìˆ˜ê°€ ë–¨ì–´ì§€ëŠ” ì œí’ˆì…ë‹ˆë‹¤.) ë°˜ëŒ€ë¡œ 191347ë²ˆ ê³ ê°ì€ 1277.5ë¥¼ ê°–ìŠµë‹ˆ	ë‹¤. ë‹¤ë¥¸ ê³ ê°ë“¤ì´ ë§ì´ êµ¬ì…í•˜ëŠ” ë³´í¸ì ì¸ í’ˆëª©ì„ êµ¬ë§¤í–ˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (GROCERY DRY GOODSì™€ ê°™ì€ 	í’ˆëª©ì´ ê·¸ë ‡ìŠµë‹ˆë‹¤.)</p>

<ol>
  <li>
    <p><strong>FinelineNumberì˜ Count Sumê°’ì„ í™œìš©</strong></p>

    <p>â€‹	ì´ ë³€ìˆ˜ëŠ” ìœ„ ë³€ìˆ˜ ë³´ë‹¤ ê°„ë‹¨í•©ë‹ˆë‹¤! í•œ ê³ ê°ì´ ëª‡ê°œì˜ FinelineNumberë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ ë°˜ì˜í•´ì£¼ëŠ” ë³€ìˆ˜ì…ë‹ˆë‹¤. ì¦‰, ëª‡ê°œì˜ ë¬¼í’ˆì„ êµ¬ë§¤í–ˆëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ê°€ ë˜ê² ìŠµë‹ˆë‹¤.</p>
  </li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FineLineSum</span> <span class="o">=</span> <span class="n">train</span><span class="p">[[</span><span class="s">'VisitNumber'</span><span class="p">,</span> <span class="s">'FinelineNumber'</span><span class="p">]].</span><span class="n">groupby</span><span class="p">(</span><span class="s">'VisitNumber'</span><span class="p">).</span><span class="n">count</span><span class="p">()</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FinelineNumber</th>
    </tr>
    <tr>
      <th>VisitNumber</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>22</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>191343</th>
      <td>7</td>
    </tr>
    <tr>
      <th>191344</th>
      <td>5</td>
    </tr>
    <tr>
      <th>191345</th>
      <td>13</td>
    </tr>
    <tr>
      <th>191346</th>
      <td>17</td>
    </tr>
    <tr>
      <th>191347</th>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>95674 rows Ã— 1 columns</p>

<p>â€‹		ìœ„ í…Œì´ë¸”ì„ data setì— ë¶™ì´ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. 5ë²ˆ ê³ ê°ì€ 1ê°œì˜ ë¬¼í’ˆë°–ì— êµ¬ë§¤í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ì— ë¹„í•´ 8	ë²ˆ ê³ ê°ì€ 22ê°œì˜ ë¬¼í’ˆì´ë‚˜ êµ¬ë§¤í–ˆë„¤ìš”! ì´ëŸ¬í•œ ì •ë³´ë“¤ì´ ê³ ê°ì˜ Typeì„ ë§ì¶”ëŠ” ë° ë„ì›€ì„ ì¤„ ê²ƒì…ë‹ˆë‹¤.</p>

<h3 id="modeling">Modeling</h3>

<p>â€‹	ìƒˆë¡œ ìƒì„±í•œ íŒŒìƒë³€ìˆ˜ë“¤ë§Œì„ ê°€ì§€ê³  Modelingì„ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤. Modelì˜ ìŠ¤í™ì€ ì•ì„œ base-line modelê³¼ ë™ì¼í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">def</span> <span class="nf">build_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">x_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)))</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'rmsprop'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="k">return</span> <span class="n">model</span>
</code></pre></div></div>

<p>â€‹	Kaggle leaderboardê¸°ì¤€ <strong>7.80</strong> ì˜ Scoreë¥¼ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤. ì•ì„œ íŒŒìƒë³€ìˆ˜ë¥¼ ìƒì„±í•˜ê¸° ì „ì— ë¹„í•´ ìƒë‹¹íˆ ì„±ëŠ¥ì´ ë‚˜ë¹ ì§„ ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>â€‹	ì´ëŠ” ì•ì„œ ì ì‹œ ì–¸ê¸‰í–ˆì—ˆë˜ dataì˜ sparsityë•Œë¬¸ì…ë‹ˆë‹¤. DepartmentDescription ë³€ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë§Œë“  íŒŒìƒë³€ìˆ˜ë“¤ì˜ ìˆ˜ê°€ ë§ì€ ë°ë‹¤ ë§ì€ í–‰ì´ 0ì˜ ê°’ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— modelì˜ ì„±ëŠ¥ì´ ë‚˜ë¹ ì§ˆ ìˆ˜ ë°–ì— ì—†ìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ì–‘í•œ ë°©ë²•ë¡ ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë³¸ ë¶„ì„ì—ì„œëŠ” Deep Learning modelì˜ layerì˜ Denseì¸µì„ ë” ëŠ˜ë¦¬ëŠ” ë°©ë²•ì„ í†µí•´ ì´ ë°©ë²•ì„ í•´ê²°í•´ë³´ê³ ì í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">def</span> <span class="nf">build_model</span><span class="p">():</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">x_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)))</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
    <span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'rmsprop'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s">'categorical_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
<span class="k">return</span> <span class="n">model</span>
</code></pre></div></div>

<p>â€‹	ì• ì„  modelì— ë¹„í•˜ì—¬ ê° ì¸µì˜ Denseë¥¼ 128ë¡œ í™•ì¥ì‹œì¼°ìŠµë‹ˆë‹¤. ì´ëŠ” ë³€ìˆ˜ê°€ ëŠ˜ì–´ë‚¨ì— ë”°ë¼ Deep Learning modelì´ í•™ìŠµí•  parameter spaceë¥¼ í™•ì¥ì‹œì¼œì£¼ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ìƒˆë¡œ í•™ìŠµí•œ modelì˜ scoreëŠ” <strong>2.27</strong> ì…ë‹ˆë‹¤. Base-line modelì— ëŒ€ë¹„í•˜ì—¬ í–¥ìƒëœ ì„±ëŠ¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>

<h2 id="cf-random-forest-simulation">cf) Random Forest Simulation</h2>

<p>â€‹	ë‹¨ìˆœí•œ í˜¸ê¸°ì‹¬ìœ¼ë¡œ Random Forestì— ìë£Œë¥¼ í•™ìŠµì‹œì¼œ ë³´ì•˜ìŠµë‹ˆë‹¤. ê° featureë“¤ì€ bayesian optimizationì„ í†µí•´ tuning í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bayes_opt</span> <span class="kn">import</span> <span class="n">BayesianOptimization</span>

<span class="n">n_folds</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">random_seed</span><span class="o">=</span><span class="mi">6</span>

<span class="c1"># BayesianOptimization
</span><span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="p">):</span>
    <span class="n">params</span><span class="p">[</span><span class="s">"n_estimators"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s">'max_depth'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_depth</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s">'min_samples_split'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_samples_split</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="s">'min_samples_leaf'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_samples_leaf</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
    <span class="n">cv_result</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rfc</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">cv_result</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s">'max_depth'</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
          <span class="p">,</span><span class="s">'min_samples_leaf'</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
          <span class="p">,</span><span class="s">'min_samples_split'</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
          <span class="p">,</span><span class="s">'n_estimators'</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
          <span class="p">}</span>


<span class="n">rfc_optimization</span> <span class="o">=</span> <span class="n">BayesianOptimization</span><span class="p">(</span><span class="nb">eval</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">init_round</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">opt_round</span> <span class="o">=</span> <span class="mi">15</span>

<span class="n">rfc_optimization</span><span class="p">.</span><span class="n">maximize</span><span class="p">(</span><span class="n">init_points</span><span class="o">=</span><span class="n">init_round</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">opt_round</span><span class="p">)</span>

<span class="n">rfc_optimization</span><span class="p">.</span><span class="nb">max</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">rfc_optimization</span><span class="p">.</span><span class="nb">max</span><span class="p">[</span><span class="s">"params"</span><span class="p">]</span>

<span class="n">op_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">"n_estimators"</span><span class="p">],</span> <span class="mi">0</span><span class="p">)),</span>
                                <span class="n">max_depth</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">"max_depth"</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
                                <span class="n">min_samples_split</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">"min_samples_split"</span><span class="p">],</span> <span class="mi">2</span><span class="p">)),</span>
                                <span class="n">min_samples_leaf</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">"min_samples_leaf"</span><span class="p">],</span><span class="mi">2</span><span class="p">)),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">op_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1">### Get prediction
</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">op_clf</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</code></pre></div></div>

<p>â€‹	ì•„ë¬´ë˜ë„ ë”¥ëŸ¬ë‹ì´ RFì— ë¹„í•´ ì¶”í›„ì— ë‚˜ì˜¨ í•™ìŠµë²•ì´ê¸° ë•Œë¬¸ì— ì•ì„  ëª¨ë¸ì— ë¹„í•´ ì„±ëŠ¥ì´ ì•ˆì¢‹ì„ ê²ƒì´ë¼ê³  ìƒê°í–ˆë˜ ì œ ì˜ˆì¸¡ì€ ì™„ë²½íˆ ì˜¤ì‚°ì´ì—ˆìŠµë‹ˆë‹¤. Kaggle ê¸°ì¤€ <strong>2.09</strong> ë¡œ í˜„ì¬ê¹Œì§€ì˜ modelë“¤ ì¤‘ ê°€ì¥ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì—¬ì¤¬ìŠµë‹ˆë‹¤.</p>

<h2 id="ì‹œì‚¬ì ">ì‹œì‚¬ì </h2>

<ol>
  <li>
    <p><strong>ë‹¨ìˆœí•œ ë”¥ëŸ¬ë‹ ëª¨ë¸ì€ ì •êµí•œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ë³´ë‹¤ ëª»í•˜ë‹¤?</strong></p>

    <p>ì•ì„œ ì‚´í´ë³¸ ê²ƒì²˜ëŸ¼ ë”¥ëŸ¬ë‹ ëª¨ë¸ì— ë¹„í•´ parameter tuningì„ ê±°ì¹œ Random Forest modelì´ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì¤¬ìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•´ í¬ê²Œ ë‘ ê°€ì§€ ì´ìœ ë¥¼ ì˜ˆìƒí•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

    <p>ë¨¼ì €, ìš°ë¦¬ê°€ ê°€ì§„ ë”¥ëŸ¬ë‹ ëª¨ë¸ì´ ë„ˆë¬´ ë‹¨ìˆœí•©ë‹ˆë‹¤. ì€ë‹‰ layerê°€ 2ê°œë¿ì´ê³  Dropoutê³¼ ê°™ì€ over-fitting ë°©ì§€ ê¸°ë²•ë“¤ë„ ì ìš©í•´ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì •êµí•˜ê²Œ tuningëœ RFì— ë¹„í•´ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ëŠ” ê²ƒì´ë¼ê³  ì˜ˆì¸¡í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

    <p>ë‹¤ìŒìœ¼ë¡œëŠ” RFì˜ Robustnessë•Œë¬¸ì…ë‹ˆë‹¤. Tree ê¸°ë°˜ì¸ RFëŠ” ë‹¤ë¥¸ ëª¨ë¸ë“¤ì— ë¹„í•´ ì•ˆì •ì ì´ê³  Robustí•œ ëª¨ë¸ë¡œ ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. DepartmentDesciption íŒŒìƒë³€ìˆ˜ë¡œ ì¸í•´ dataì˜ sparsityê°€ ë†’ì•„ì§„ ì§€ê¸ˆ, ì´ëŸ¬í•œ RFì˜ íŠ¹ì§•ì´ ë¹›ì„ ë°œí•œ ê²ƒìœ¼ë¡œ ìƒê°ë©ë‹ˆë‹¤. ë”°ë¼ì„œ PCAë“±ê³¼ ê°™ì´ Spasityë¥¼ ì¡ì•„ì£¼ëŠ” ë°©ë²•ì„ ì ìš©í•˜ì—¬ ë”¥ëŸ¬ë‹ ëª¨ë¸ì— ì ìš©í•œë‹¤ë©´ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ì–»ì„ ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>ê²°ì¸¡ê°’ imputation</strong></p>

    <p>ìœ„ ë¶„ì„ì—ì„œ ê²°ì¸¡ê°’ì— ëŒ€í•œ ì²˜ë¦¬ëŠ” ë”°ë¡œ í•´ì£¼ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” ê²°ì¸¡ê°’ì´ 3,000ì—¬ ê°œë¡œ ì „ì²´ datasetí¬ê¸° ëŒ€ë¹„ ì‘ì•˜ê¸° ë•Œë¬¸ì¸ë°ìš”. ê·¸ë˜ë„ ì´ ë¶€ë¶„ì— ëŒ€í•œ imputationì´ ì´ë£¨ì–´ì¡Œë‹¤ë©´ ë” ì¢‹ì€ ë¶„ì„ì´ ë˜ì—ˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
  </li>
</ol>
:ET